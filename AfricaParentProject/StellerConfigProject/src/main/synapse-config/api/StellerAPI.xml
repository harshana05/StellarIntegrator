<?xml version="1.0" encoding="UTF-8"?>
<api xmlns="http://ws.apache.org/ns/synapse"
     name="StellerAPI"
     context="/steller">
   <resource methods="POST" uri-template="/generateKeys">
      <inSequence>
         <log level="custom">
            <property name="InComing" value="Request Path"/>
         </log>
         <payloadFactory media-type="json">
            <format>{"method":"create_keys"}</format>
            <args/>
         </payloadFactory>
         <property name="ContentType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/getStellerdFromBot?address={address}">
      <inSequence>
         <log level="custom">
            <property name="InComing" value="Request Path"/>
         </log>
         <property name="ContentType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerFriendBotEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/accountInfo?address={address}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_info",
    "params": [
        {
            "account": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.address')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/payment?type={type}">
      <inSequence>
         <filter source="get-property('query.param.type')" regex="STR">
            <then>
               <payloadFactory media-type="json">
                  <format>
            {
  "method": "submit",
  "params": [
    {
      "secret": "$1",
      "tx_json": {
        "TransactionType": "Payment",
        "Account": "$2",
        "Destination": "$3",
        "Amount": "$4"
      }
    }
  ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.DestinationAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount"/>
                  </args>
               </payloadFactory>
            </then>
            <else>
               <payloadFactory media-type="json">
                  <format>
            {
  "method": "submit",
  "params": [
    {
      "secret": "$1",
      "tx_json": {
        "TransactionType": "Payment",
        "Account": "$2",
        "Destination": "$3",
        "Amount": {
          "currency": "$4",
          "value": "$5",
          "issuer": "$6"
        }
      }
    }
  ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.DestinationAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.Currency"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.Value"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.IssuerId"/>
                  </args>
               </payloadFactory>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/trx?trxHash={trxHash}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "tx",
    "params": [
        {
            "transaction": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.trxHash')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET"
             uri-template="/trx?trxHash={trxHash}&amp;ledgerIndex={ledgerIndex}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "transaction_entry",
    "params": [
        {
            "tx_hash": "$1",
            "ledger_index": $2
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.trxHash')"/>
               <arg evaluator="xml" expression="get-property('query.param.ledgerIndex')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/trxHistory?startIndex={startIndex}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "tx_history",
    "params": [
        {
            "start": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.startIndex')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET"
             uri-template="/accountTrx?accountId={accountId}&amp;limit={limit}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_tx",
    "params": [
        {
            "account": "$1",
            "limit": $2
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.accountId')"/>
               <arg evaluator="xml" expression="get-property('query.param.limit')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/accountCurrencies?accountId={accountId}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_currencies",
    "params": [
        {
            "account": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.accountId')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/accountLines?accountId={accountId}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_lines",
    "params": [
        {
            "account": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.accountId')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/accountOffers?accountId={accountId}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_offers",
    "params": [
        {
            "account": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.accountId')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/bookOffer">
      <inSequence>
         <filter source="//APIRequest/takerGets/Currency" regex="STR">
            <then>
               <filter source="//APIRequest/takerPays/Currency" regex="STR">
                  <then>
                     <payloadFactory media-type="json">
                        <format>
            {
  "APIResponse": {
    "StatusCode": "100000",
    "Description": "Invalid Offer Type"
  }
}
           </format>
                        <args/>
                     </payloadFactory>
                     <property name="messageType"
                               value="application/json"
                               scope="axis2"
                               type="STRING"/>
                     <respond/>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>

            {
    "method": "book_offers",
    "params": [
        {
            "taker_gets": {
                "currency": "STR"
            },
            "taker_pays": {
                "issuer": "$1",
                "currency": "$2"
            }
        }
    ]
}

           </format>
                        <args>
                           <arg evaluator="xml" expression="//APIRequest/takerPays/Issuer"/>
                           <arg evaluator="xml" expression="//APIRequest/takerPays/Currency"/>
                        </args>
                     </payloadFactory>
                  </else>
               </filter>
            </then>
            <else>
               <filter source="//APIRequest/takerPays/Currency" regex="STR">
                  <then>
                     <payloadFactory media-type="json">
                        <format>

            {
    "method": "book_offers",
    "params": [
        {
            "taker_gets": {
                "currency": "$1",
                "issuer": "$2"
            },
            "taker_pays": {
                "currency": "STR"
            }
        }
    ]
}

           </format>
                        <args>
                           <arg evaluator="xml" expression="//APIRequest/takerGets/Currency"/>
                           <arg evaluator="xml" expression="//APIRequest/takerGets/Issuer"/>
                        </args>
                     </payloadFactory>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>

            {
    "method": "book_offers",
    "params": [
        {
            "taker_gets": {
                "currency": "$1",
                "issuer": "$2"
            },
            "taker_pays": {
                "issuer": "$3",
                "currency": "$4"
            }
        }
    ]
}

           </format>
                        <args>
                           <arg evaluator="xml" expression="//APIRequest/takerGets/Currency"/>
                           <arg evaluator="xml" expression="//APIRequest/takerGets/Issuer"/>
                           <arg evaluator="xml" expression="//APIRequest/takerPays/Issuer"/>
                           <arg evaluator="xml" expression="//APIRequest/takerPays/Currency"/>
                        </args>
                     </payloadFactory>
                  </else>
               </filter>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/lookupStaticPaths">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "static_path_find",
    "params": [
        {
            "source_account": "$1",
            "destination_account": "$2",
            "destination_amount": {
                "currency": "$3",
                "value": "$4",
                "issuer": "$5"
            }
        }
    ]
}
           </format>
            <args>
               <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
               <arg evaluator="json" expression="$.APIRequest.DestinationAcctId"/>
               <arg evaluator="json" expression="$.APIRequest.DestinationAmount.Currency"/>
               <arg evaluator="json" expression="$.APIRequest.DestinationAmount.Value"/>
               <arg evaluator="json" expression="$.APIRequest.DestinationAmount.Issuer"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/getLedger">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            { "method" : "ledger" }
           </format>
            <args/>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/signPayment?type={type}">
      <inSequence>
         <filter source="get-property('query.param.type')" regex="STR">
            <then>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "sign",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "Payment",
                "Account": "$2",
                "Destination": "$3",
                "Amount": "$4"
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.DestinationAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount"/>
                  </args>
               </payloadFactory>
            </then>
            <else>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "sign",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "Payment",
                "Account": "$2",
                "Destination": "$3",
                "Amount": {
                    "currency": "$4",
                    "issuer": "$5",
                    "value": "$6"
                }
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.DestinationAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.Currency"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.IssuerId"/>
                     <arg evaluator="json" expression="$.APIRequest.Amount.Value"/>
                  </args>
               </payloadFactory>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/submitPayment">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "submit",
    "params": [
        {
            "tx_blob": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="json" expression="$.APIRequest.TrxBlob"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/setCommission">
      <inSequence>
         <filter xpath="//APIRequest/Commission &gt;= 1000000000">
            <then>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "AccountSet",
                "Account": "$2",
                "TransferRate": "$3"
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Commission"/>
                  </args>
               </payloadFactory>
            </then>
            <else>
               <payloadFactory media-type="json">
                  <format>
            {
  "APIResponse": {
    "StatusCode": "100001",
    "Description": "Invalid Commission Amount"
  }
}
           </format>
                  <args/>
               </payloadFactory>
               <respond/>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/setRegularKey">
      <inSequence>
         <filter source="boolean(//APIRequest/RegularKey)" regex="true">
            <then>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "SetRegularKey",
                "Account": "$2",
                "RegularKey": "$3"
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.RegularKey"/>
                  </args>
               </payloadFactory>
            </then>
            <else>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "SetRegularKey",
                "Account": "$2"
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                  </args>
               </payloadFactory>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/flagAccount?type={type}">
      <inSequence>
         <filter source="get-property('query.param.type')" regex="SET">
            <then>
               <filter source="//APIRequest/AcctFlag" regex="1|2|4">
                  <then>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "AccountSet",
                "Account": "$2",
                "SetFlag": "$3"
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.AcctFlag"/>
                        </args>
                     </payloadFactory>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>
            {
  "APIResponse": {
    "StatusCode": "100002",
    "Description": "Invalid Account Flag to Set"
  }
}
           </format>
                        <args/>
                     </payloadFactory>
                     <respond/>
                  </else>
               </filter>
            </then>
            <else>
               <filter source="//APIRequest/AcctFlag" regex="1|2|4">
                  <then>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "AccountSet",
                "Account": "$2",
                "ClearFlag": "$3"
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.AcctFlag"/>
                        </args>
                     </payloadFactory>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>
            {
  "APIResponse": {
    "StatusCode": "100002",
    "Description": "Invalid Account Flag to Clear"
  }
}
           </format>
                        <args/>
                     </payloadFactory>
                     <respond/>
                  </else>
               </filter>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/offerCreate?from={from}&amp;to={to}">
      <inSequence>
         <filter source="get-property('query.param.from')" regex="STR">
            <then>
               <filter source="get-property('query.param.to')" regex="STR">
                  <then>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "OfferCreate",
                "Account": "$2",
                "TakerGets": "$3",
                "TakerPays": "$4"
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Value"/>
                        </args>
                     </payloadFactory>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "OfferCreate",
                "Account": "$2",
                "TakerGets": "$3",
                "TakerPays": {
                    "currency": "$4",
                    "value": "$5",
                    "issuer": "$6"
                }
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Currency"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Issuer"/>
                        </args>
                     </payloadFactory>
                  </else>
               </filter>
            </then>
            <else>
               <filter source="get-property('query.param.to')" regex="STR">
                  <then>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "OfferCreate",
                "Account": "$2",
                "TakerGets": {
                    "currency": "$3",
                    "value": "$4",
                    "issuer": "$5"
                },
                "TakerPays": "$6"
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Currency"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Issuer"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Value"/>
                        </args>
                     </payloadFactory>
                  </then>
                  <else>
                     <payloadFactory media-type="json">
                        <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "OfferCreate",
                "Account": "$2",
                "TakerGets": {
                    "currency": "$3",
                    "value": "$4",
                    "issuer": "$5"
                },
                "TakerPays": {
                    "currency": "$6",
                    "value": "$7",
                    "issuer": "$8"
                }
            }
        }
    ]
}
           </format>
                        <args>
                           <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                           <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Currency"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerGets.Issuer"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Currency"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Value"/>
                           <arg evaluator="json" expression="$.APIRequest.TakerPays.Issuer"/>
                        </args>
                     </payloadFactory>
                  </else>
               </filter>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/offerCancel">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "OfferCancel",
                "Account": "$2",
                "OfferSequence": "$3"
            }
        }
    ]
}
           </format>
            <args>
               <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
               <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
               <arg evaluator="json" expression="$.APIRequest.OfferSequenceId"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/trustSet?type={type}">
      <inSequence>
         <filter source="get-property('query.param.type')" regex="SET">
            <then>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "TrustSet",
                "Account": "$2",
                "LimitAmount": {
                    "currency": "$3",
                    "value": "$4",
                    "issuer": "$5"
                },
                "Flags": 131072
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Limit.Currency"/>
                     <arg evaluator="json" expression="$.APIRequest.Limit.Value"/>
                     <arg evaluator="json" expression="$.APIRequest.Limit.Issuer"/>
                  </args>
               </payloadFactory>
            </then>
            <else>
               <payloadFactory media-type="json">
                  <format>
            {
    "method": "submit",
    "params": [
        {
            "secret": "$1",
            "tx_json": {
                "TransactionType": "TrustSet",
                "Account": "$2",
                "LimitAmount": {
                    "currency": "$3",
                    "value": "0",
                    "issuer": "$4"
                },
                "Flags": 262144
            }
        }
    ]
}
           </format>
                  <args>
                     <arg evaluator="json" expression="$.APIRequest.SourceSecret"/>
                     <arg evaluator="json" expression="$.APIRequest.SourceAcctId"/>
                     <arg evaluator="json" expression="$.APIRequest.Limit.Currency"/>
                     <arg evaluator="json" expression="$.APIRequest.Limit.Issuer"/>
                  </args>
               </payloadFactory>
            </else>
         </filter>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
</api>
