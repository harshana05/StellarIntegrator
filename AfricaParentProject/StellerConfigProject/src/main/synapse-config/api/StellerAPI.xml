<?xml version="1.0" encoding="UTF-8"?>
<api xmlns="http://ws.apache.org/ns/synapse"
     name="StellerAPI"
     context="/steller">
   <resource methods="POST" uri-template="/generateKeys">
      <inSequence>
         <log level="custom">
            <property name="InComing" value="Request Path"/>
         </log>
         <payloadFactory media-type="json">
            <format>{"method":"create_keys"}</format>
            <args/>
         </payloadFactory>
         <property name="ContentType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/getStellerdFromBot?address={address}">
      <inSequence>
         <log level="custom">
            <property name="InComing" value="Request Path"/>
         </log>
         <property name="ContentType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerFriendBotEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="GET" uri-template="/accountInfo?address={address}">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
    "method": "account_info",
    "params": [
        {
            "account": "$1"
        }
    ]
}
           </format>
            <args>
               <arg evaluator="xml" expression="get-property('query.param.address')"/>
            </args>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
   <resource methods="POST" uri-template="/payment">
      <inSequence>
         <payloadFactory media-type="json">
            <format>
            {
  "method": "submit",
  "params": [
    {
      "secret": "sfwtwgV3zHekZMm6F2cNPzEGzogQqPMEZcdVftKnrstngZvotYr",
      "tx_json": {
        "TransactionType": "Payment",
        "Account": "gM4Fpv2QuHY4knJsQyYGKEHFGw3eMBwc1U",
        "Destination": "g4eRqgZfzfj3132y17iaf2fp6HQj1gofjt",
        "Amount": {
          "currency": "USD",
          "value": "2",
          "issuer": "gBAde4mkDijZatAdNhBzCsuC7GP4MzhA3B"
        }
      }
    }
  ]
}
           </format>
            <args/>
         </payloadFactory>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <property name="FORCE_HTTP_1.0" value="true" scope="axis2" type="STRING"/>
         <property name="DISABLE_CHUNKING"
                   value="true"
                   scope="axis2"
                   type="STRING"/>
         <send>
            <endpoint key="StellerTestEndpoint"/>
         </send>
      </inSequence>
      <outSequence>
         <property name="messageType"
                   value="application/json"
                   scope="axis2"
                   type="STRING"/>
         <log level="full"/>
         <send/>
      </outSequence>
      <faultSequence/>
   </resource>
</api>
